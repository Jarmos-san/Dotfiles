#!/usr/bin/env python3

"""
Simplied "git-clone" command.

Quickly and easily clone a remote Git repository to the local development environment
for further development. Creating a well-documented alias for the "clone" command using
Shell scripts was unweildy and hard to manage. Hence, this script come handy in that
regards!

Usage guidelines:

    Invoke the script like so "clone [remote repo] [local repo]" (assuming the script is
    in "PATH"). More specifically following is a detailed help documentation for the
    script.

    clone:      The command to invoke the script
    remote:     The name of the remote repository, on GitHub (example -
                "Jarmos-san/dotfiles")
    local:      The name of the local repository

Author: Somraj Saha
License: GPL-3.0 (see https://github.com/Jarmos-san/dotfiles/blob/main/LICENSE for more
                  information)
"""

import argparse
import pathlib
import subprocess


def parse_args() -> argparse.Namespace:
    """Parse the arguments passed to the script and return a Namespace Object."""
    parser = argparse.ArgumentParser(description="Clone a remote GitHub repository!")

    # Add the positional arg "repo" to the "parser" Object
    parser.add_argument(
        "repo",
        help='The name of the remote repository, example - "Jarmos-san/dotfiles"',
    )

    # Add the optional flag "--dest" to the "parser" Object
    parser.add_argument(
        "--dest",
        help="The local destination to clone the repository to",
        required=False,
        type=pathlib.Path,
    )

    return parser.parse_args()


def main() -> None:
    """Invoke the entrypoint of the script."""
    # Parse all the flags and args to the "clone" script
    args = parse_args()

    # Conditional operation to clone repo to a local repository (which can be
    # optionally passed)
    if not args.dest:
        subprocess.run(["git", "clone", f"git@github.com:{args.repo}"], check=True)
    else:
        subprocess.run(
            ["git", "clone", f"git@github.com:{args.repo}", f"{args.dest}"], check=True
        )


if __name__ == "__main__":
    main()
